import { useData } from 'nextra/data'
import React from 'react'

export const getStaticProps = async () => {
  const res = await fetch('https://mainnet-beta.api.drift.trade/stats/perpMarketAccounts')
  const data = await res.json()

  const tableData = data.result.map((market, index) => {
    const name = market.name
      .map((charCode) => String.fromCharCode(charCode))
      .join('')
      .trim()

    return {
      index,
      name,
      marginRatioInitial: market.marginRatioInitial,
      marginRatioMaintenance: market.marginRatioMaintenance,
      imfFactor: market.imfFactor,
    }
  })

  return {
    props: {
      ssg: { tableData },
    },
    revalidate: 3600,
  }
}
